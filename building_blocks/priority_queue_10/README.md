
# Performance

2 CC per insertion

for STREAM_LEN = 1024
```
    * Summary: 
    +---------+---------+-----------+-----------+------+------+----------+
    |  Latency (cycles) |   Latency (absolute)  |   Interval  | Pipeline |
    |   min   |   max   |    min    |    max    |  min |  max |   Type   |
    +---------+---------+-----------+-----------+------+------+----------+
    |     2104|     2104| 10.520 us | 10.520 us |  2099|  2099| dataflow |
    +---------+---------+-----------+-----------+------+------+----------+

        * Instance: 
        +---------------------------+--------------------------+---------+---------+-----------+-----------+------+------+---------+
        |                           |                          |  Latency (cycles) |   Latency (absolute)  |   Interval  | Pipeline|
        |          Instance         |          Module          |   min   |   max   |    min    |    max    |  min |  max |   Type  |
        +---------------------------+--------------------------+---------+---------+-----------+-----------+------+------+---------+
        |priority_queue_10_1024_U0  |priority_queue_10_1024_s  |     2098|     2098| 10.490 us | 10.490 us |  2098|  2098|   none  |
        |read_input_1024_5_U0       |read_input_1024_5         |     1033|     1033|  5.165 us |  5.165 us |  1033|  1033|   none  |
        |write_result_10_U0         |write_result_10_s         |       18|       18| 90.000 ns | 90.000 ns |    18|    18|   none  |
        +---------------------------+--------------------------+---------+---------+-----------+-----------+------+------+---------+
```

# Resource Consumption



## PQ 10, without final sorting


priority_queue_10_1024: FF = 1442, LUT = 2775

How many such PQ can we implement?

FF: 2607360 / 1442 = 1808.15

LUT: 1303680 / 2775 = 469.79

We can afford 469 such architecture, still consuming too much resources...

2 CC per insertion, suppose 27 HBM channel -> 81 streams x 2, need 160 PQs, consuming 34% LUTs.

```
================================================================
== Utilization Estimates
================================================================
* Summary: 
+---------------------+---------+-------+---------+---------+-----+
|         Name        | BRAM_18K| DSP48E|    FF   |   LUT   | URAM|
+---------------------+---------+-------+---------+---------+-----+
|DSP                  |        -|      -|        -|        -|    -|
|Expression           |        -|      -|        0|       16|    -|
|FIFO                 |        2|      -|       70|      193|    -|
|Instance             |        4|      0|     5123|     8793|    -|
|Memory               |        -|      -|        -|        -|    -|
|Multiplexer          |        -|      -|        -|        -|    -|
|Register             |        -|      -|        6|        -|    -|
+---------------------+---------+-------+---------+---------+-----+
|Total                |        6|      0|     5199|     9002|    0|
+---------------------+---------+-------+---------+---------+-----+
|Available SLR        |     1344|   3008|   869120|   434560|  320|
+---------------------+---------+-------+---------+---------+-----+
|Utilization SLR (%)  |    ~0   |      0|    ~0   |        2|    0|
+---------------------+---------+-------+---------+---------+-----+
|Available            |     4032|   9024|  2607360|  1303680|  960|
+---------------------+---------+-------+---------+---------+-----+
|Utilization (%)      |    ~0   |      0|    ~0   |    ~0   |    0|
+---------------------+---------+-------+---------+---------+-----+

+ Detail: 
    * Instance: 
    +---------------------------+--------------------------+---------+-------+------+------+-----+
    |          Instance         |          Module          | BRAM_18K| DSP48E|  FF  |  LUT | URAM|
    +---------------------------+--------------------------+---------+-------+------+------+-----+
    |priority_queue_10_1024_U0  |priority_queue_10_1024_s  |        0|      0|  1442|  2775|    0|
    |read_input_1024_5_U0       |read_input_1024_5         |        0|      0|    59|   174|    0|
    |vadd_control_s_axi_U       |vadd_control_s_axi        |        0|      0|  2486|  4520|    0|
    |vadd_gmem0_m_axi_U         |vadd_gmem0_m_axi          |        2|      0|   512|   580|    0|
    |vadd_gmem34_m_axi_U        |vadd_gmem34_m_axi         |        2|      0|   512|   580|    0|
    |write_result_10_U0         |write_result_10_s         |        0|      0|   112|   164|    0|
    +---------------------------+--------------------------+---------+-------+------+------+-----+
    |Total                      |                          |        4|      0|  5123|  8793|    0|
    +---------------------------+--------------------------+---------+-------+------+------+-----+
```

## PQ 10, with final sorting


priority_queue_10_1024: FF = 2513, LUT = 4979

How many such PQ can we implement?

FF: 2607360 / 2513 = 1037.54

LUT: 1303680 / 4979 = 261.83

We can afford 261 such architecture, still consuming too much resources...

2 CC per insertion, suppose 27 HBM channel -> 81 streams x 2, need 160 PQs, consuming most LUTs (This is even worse than a pipelined 128 Sorting Network)


```
================================================================
== Utilization Estimates
================================================================
* Summary: 
+---------------------+---------+-------+---------+---------+-----+
|         Name        | BRAM_18K| DSP48E|    FF   |   LUT   | URAM|
+---------------------+---------+-------+---------+---------+-----+
|DSP                  |        -|      -|        -|        -|    -|
|Expression           |        -|      -|        0|       16|    -|
|FIFO                 |        2|      -|       70|      193|    -|
|Instance             |        4|      0|     6194|    10997|    -|
|Memory               |        -|      -|        -|        -|    -|
|Multiplexer          |        -|      -|        -|        -|    -|
|Register             |        -|      -|        6|        -|    -|
+---------------------+---------+-------+---------+---------+-----+
|Total                |        6|      0|     6270|    11206|    0|
+---------------------+---------+-------+---------+---------+-----+
|Available SLR        |     1344|   3008|   869120|   434560|  320|
+---------------------+---------+-------+---------+---------+-----+
|Utilization SLR (%)  |    ~0   |      0|    ~0   |        2|    0|
+---------------------+---------+-------+---------+---------+-----+
|Available            |     4032|   9024|  2607360|  1303680|  960|
+---------------------+---------+-------+---------+---------+-----+
|Utilization (%)      |    ~0   |      0|    ~0   |    ~0   |    0|
+---------------------+---------+-------+---------+---------+-----+

+ Detail: 
    * Instance: 
    +---------------------------+--------------------------+---------+-------+------+------+-----+
    |          Instance         |          Module          | BRAM_18K| DSP48E|  FF  |  LUT | URAM|
    +---------------------------+--------------------------+---------+-------+------+------+-----+
    |priority_queue_10_1024_U0  |priority_queue_10_1024_s  |        0|      0|  2513|  4979|    0|
    |read_input_1024_5_U0       |read_input_1024_5         |        0|      0|    59|   174|    0|
    |vadd_control_s_axi_U       |vadd_control_s_axi        |        0|      0|  2486|  4520|    0|
    |vadd_gmem0_m_axi_U         |vadd_gmem0_m_axi          |        2|      0|   512|   580|    0|
    |vadd_gmem34_m_axi_U        |vadd_gmem34_m_axi         |        2|      0|   512|   580|    0|
    |write_result_10_U0         |write_result_10_s         |        0|      0|   112|   164|    0|
    +---------------------------+--------------------------+---------+-------+------+------+-----+
    |Total                      |                          |        4|      0|  6194| 10997|    0|
    +---------------------------+--------------------------+---------+-------+------+------+-----+

```